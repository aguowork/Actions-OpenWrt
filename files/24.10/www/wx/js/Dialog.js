import{e,M as t,f as s,i as o,T as a,w as r,p as n,o as l,j as i,g as c,u,l as w,m as d,t as y,Q as m}from"./vue-vendor.js";import{c as f,_ as h}from"./index.js";
/**
 * @license lucide-vue-next v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const g=f("x",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);const b=new class{constructor(){}async callViaCgi(e,t={}){const s=Object.keys(t).length>0,o=`/cgi-bin/wx-auth.sh?action=ubus&method=${e}`,a="auto_switch"===e?12e4:3e4,r=new AbortController,n=setTimeout(()=>r.abort(),a);try{const a=localStorage.getItem("wx_auth_token"),i=await fetch(o,{method:s?"POST":"GET",headers:{...s?{"Content-Type":"application/json"}:{},...a?{Authorization:a}:{}},body:s?JSON.stringify(t):void 0,signal:r.signal});if(clearTimeout(n),!i.ok)throw new Error(`HTTP错误: ${i.status}`);const c=await i.text();if(!c.trim())throw new Error("服务器返回空响应");let u;try{u=JSON.parse(c)}catch(l){throw new Error("服务器返回无效的JSON格式")}if("error"===u.status){if(401===u.code||"未授权的操作"===u.message)return localStorage.removeItem("wx_auth_token"),localStorage.removeItem("ubus_session"),localStorage.removeItem("wx_authenticated"),localStorage.removeItem("wx_auth_time"),localStorage.setItem("wx_logout_reason","conflict"),window.location.reload(),new Promise(()=>{});if("auto_switch"===e)return u;throw new Error(u.message||"请求失败")}return u}catch(i){if(clearTimeout(n),i instanceof Error&&"AbortError"===i.name)throw new Error("请求超时");throw i}}async call(e,t,s={}){if("wx-wireless"===e)return this.callViaCgi(t,s);throw new Error(`Does not support generic ubus calls: ${e}.${t}`)}async batch(e){return Promise.all(e.map(({object:e,method:t,params:s})=>this.call(e,t,s)))}};async function _(){return b.call("wx-wireless","get_status",{})}async function x(){return b.call("wx-wireless","get_wireless_settings",{})}async function p(e){return b.call("wx-wireless","save_wireless_settings",e)}async function v(e){return b.call("wx-wireless","connect",e)}async function k(){return(await b.call("wx-wireless","get_known_networks",{})).wifi||[]}async function T(e){return b.call("wx-wireless","save_network",e)}async function S(e){return b.call("wx-wireless","delete_networks",{names:e})}async function E(e){return b.call("wx-wireless","save_order",{wifi:e})}async function j(){return b.call("wx-wireless","auto_switch",{})}async function C(){return b.call("wx-wireless","get_crontab",{})}async function I(e){return b.call("wx-wireless","set_crontab",{interval:e})}async function $(){return b.call("wx-wireless","get_retry_status",{})}async function O(){return b.call("wx-wireless","reset_retry_count",{})}const P={class:"dialog-content"},z={key:0,class:"dialog-title"},A={class:"relative z-10"},D={class:"mt-6 flex gap-3 relative z-10"},J=h(e({__name:"Dialog",props:{visible:{type:Boolean},title:{},icon:{}},emits:["close"],setup(e,{emit:f}){const h=e,b=f;function _(e){e.target===e.currentTarget&&b("close")}let x=0;return t(()=>h.visible,e=>{e?(x=window.scrollY,document.body.style.position="fixed",document.body.style.top=`-${x}px`,document.body.style.left="0",document.body.style.right="0",document.body.style.width="100%",document.body.style.overflow="hidden"):(document.body.style.position="",document.body.style.top="",document.body.style.left="",document.body.style.right="",document.body.style.width="",document.body.style.overflow="",window.scrollTo(0,x))},{immediate:!0}),(t,f)=>(l(),s(n,{to:"body"},[o(a,{name:"dialog"},{default:r(()=>[e.visible?(l(),i("div",{key:0,class:"dialog-overlay",onClick:_},[c("div",P,[c("button",{class:"absolute top-4 right-4 w-8 h-8 rounded-lg bg-slate-700/50 hover:bg-slate-700 flex items-center justify-center text-slate-400 hover:text-white transition-colors",onClick:f[0]||(f[0]=e=>b("close"))},[o(u(g),{class:"w-4 h-4"})]),e.title?(l(),i("div",z,[e.icon?(l(),s(w(e.icon),{key:0,class:"w-5 h-5 text-primary-400"})):d("",!0),c("span",null,y(e.title),1)])):d("",!0),c("div",A,[m(t.$slots,"default",{},void 0,!0)]),c("div",D,[m(t.$slots,"footer",{},()=>[c("button",{class:"btn btn-primary flex-1",onClick:f[1]||(f[1]=e=>b("close"))},"确定")],!0)])])])):d("",!0)]),_:3})]))}}),[["__scopeId","data-v-2dd5689e"]]);export{J as D,g as X,k as a,x as b,v as c,T as d,S as e,E as f,_ as g,$ as h,C as i,I as j,O as r,p as s,j as t};
