import{e,v as s,j as a,g as l,i as t,u as n,y as i,B as r,z as o,A as c,J as u,f as d,l as p,m,w as v,F as y,r as f,c as b,o as x,G as h,t as w,k,C as g,I as j}from"./vue-vendor.js";import{u as C}from"./wireless2.js";import{c as W,a as F,T as S,L as G}from"./index.js";import{g as M,D as N,s as P}from"./Dialog.js";import{a as A,S as V}from"./Select.js";import{E as L,a as U,b as _,c as z}from"./validation.js";import{W as q}from"./wifi.js";import{L as E}from"./lock.js";import{R as K}from"./radio.js";import{L as B}from"./lock-open.js";
/**
 * @license lucide-vue-next v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const D=W("chevron-right",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]),T=W("link",[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]]),I=W("search",[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]]),J=W("shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]),O=W("wifi-off",[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}],["path",{d:"M5 12.859a10 10 0 0 1 5.17-2.69",key:"1dl1wf"}],["path",{d:"M19 12.859a10 10 0 0 0-2.007-1.523",key:"4k23kn"}],["path",{d:"M2 8.82a15 15 0 0 1 4.177-2.643",key:"1grhjp"}],["path",{d:"M22 8.82a15 15 0 0 0-11.288-3.764",key:"z3jwby"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]),R={class:"space-y-4"},H={class:"flex items-center gap-3 px-1"},Q={class:"w-9 h-9 rounded-xl bg-gradient-to-br from-primary-500/20 to-primary-600/10 flex items-center justify-center"},X={class:"flex items-center gap-3"},Y={class:"w-10 h-10 rounded-lg bg-primary-500/20 flex items-center justify-center"},Z={class:"form-group"},$={class:"flex items-center justify-between"},ee={class:"form-label"},se=["disabled"],ae={class:"form-group"},le={class:"form-label"},te={key:0,class:"form-group"},ne={class:"form-label"},ie={class:"relative group/input"},re=["type"],oe={class:"form-group"},ce={class:"form-label"},ue={class:"flex gap-3 pt-2"},de={class:"max-h-72 overflow-y-auto -mx-2 scrollbar-smart"},pe={key:0,class:"text-center py-12"},me={class:"inline-flex items-center justify-center w-16 h-16 rounded-full bg-slate-700/50 mb-4"},ve=["onClick"],ye={class:"flex items-center gap-3"},fe={class:"w-10 h-10 rounded-lg bg-primary-500/20 flex items-center justify-center"},be={class:"text-white font-medium"},xe={class:"flex gap-2"},he={class:"badge"},we={class:"space-y-4"},ke={class:"flex items-start gap-3 p-4 rounded-xl bg-warning-500/10 border border-warning-500/20"},ge={class:"h-80 overflow-y-auto -mx-2 scrollbar-smart"},je={key:0,class:"flex flex-col items-center justify-center h-full"},Ce={class:"inline-flex items-center justify-center w-16 h-16 rounded-full bg-primary-500/10 mb-4"},We={key:1,class:"flex flex-col items-center justify-center h-full"},Fe={class:"inline-flex items-center justify-center w-16 h-16 rounded-full bg-primary-500/10 mb-4"},Se={key:2,class:"flex flex-col items-center justify-center h-full"},Ge={class:"inline-flex items-center justify-center w-16 h-16 rounded-full bg-slate-700/50 mb-4"},Me=["onClick"],Ne={class:"flex items-center gap-3 min-w-0 flex-1"},Pe={class:"w-10 h-10 rounded-lg bg-slate-800/50 flex items-center justify-center flex-shrink-0"},Ae={class:"w-6 h-6",viewBox:"0 0 24 24",fill:"none"},Ve={class:"min-w-0 flex-1"},Le={class:"text-white font-medium truncate"},Ue={class:"text-xs text-slate-500"},_e=["disabled"],ze=e({__name:"Connect",setup(e){const W=f(!1),ze=g(),qe=C(),Ee=F(),Ke=f(!1),Be=f(!1),De=f(!1),Te=f(!1),Ie=f({ssid:"",encryption:"psk2",key:"",band:""}),Je=[{value:"psk2",label:"WPA2-PSK (强安全性)"},{value:"sae",label:"WPA3-SAE (强安全性)"},{value:"psk",label:"WPA-PSK (弱安全性)"},{value:"owe",label:"OWE (开放网络)"},{value:"none",label:"无加密 (开放网络)"}],Oe=b(()=>"none"!==Ie.value.encryption&&"owe"!==Ie.value.encryption);function Re(e){if(!e.enabled)return"无加密";const s=e.wpa||[];return s.includes(1)&&s.includes(2)?"WPA/WPA2":s.includes(2)?"WPA2":s.includes(1)?"WPA":"加密"}function He(e){return e>=-50?"极强":e>=-60?"强":e>=-70?"中":e>=-80?"弱":"极弱"}function Qe(e){return e>=-50?{level:3,hex:"#4ade80"}:e>=-65?{level:2,hex:"#4ade80"}:e>=-75?{level:1,hex:"#fbbf24"}:{level:0,hex:"#f87171"}}s(async()=>{qe.fetchKnownNetworks();try{const[e,s]=await Promise.all([M("2g"),M("5g")]),a=(e.results||[]).map(e=>({...e,band:"2.4G"})),l=(s.results||[]).map(e=>({...e,band:"5G"})),t=[...a,...l];t.length>0&&(qe.scannedNetworks=t,Te.value=!0)}catch{}});const Xe=b(()=>qe.scannedNetworks.filter(e=>e.ssid).sort((e,s)=>s.signal-e.signal));function Ye(){De.value=!0}async function Ze(){qe.scannedNetworks=[],qe.isScanning=!0,Te.value=!0;try{const[e,s]=await Promise.all([P("2g"),P("5g")]),a=(e.results||[]).map(e=>({...e,band:"2.4G"})),l=(s.results||[]).map(e=>({...e,band:"5G"}));qe.scannedNetworks=[...a,...l]}catch(e){}finally{qe.isScanning=!1}}function $e(){De.value=!1}function es(){as()&&(Be.value=!0)}async function ss(){if(!as())return;await qe.saveNetwork({name:Ie.value.ssid,encryption:Ie.value.encryption,password:Ie.value.key,band:Ie.value.band})?(Ee.success("配置已保存"),Ie.value={ssid:"",encryption:"psk2",key:"",band:""}):Ee.error(qe.error||"保存失败")}function as(){return _(Ie.value.ssid)?Ie.value.band?Oe.value&&!Ie.value.key?(Ee.error("请输入WiFi密码"),!1):!(Oe.value&&!z(Ie.value.key))||(Ee.error("密码只能包含英文、数字和符号，长度8-63位"),!1):(Ee.error("请选择频段"),!1):(Ee.error("请输入有效的WiFi名称 (1-32字符)"),!1)}async function ls(){Be.value=!1,Ee.showLoading("正在尝试连接"),await qe.saveNetwork({name:Ie.value.ssid,encryption:Ie.value.encryption,password:Ie.value.key,band:Ie.value.band});await qe.connectToWiFi({ssid:Ie.value.ssid,encryption:Ie.value.encryption,key:Ie.value.key,band:Ie.value.band.toLowerCase()})?Ee.startCountdown(60,()=>{Ee.hideLoading(),ze.push({name:"status"})}):(Ee.hideLoading(),Ee.error(qe.error||"连接失败"))}return(e,s)=>(x(),a(y,null,[l("div",R,[l("div",H,[l("div",Q,[t(n(T),{class:"w-4 h-4 text-primary-400"})]),s[11]||(s[11]=l("div",null,[l("h2",{class:"text-lg font-bold text-white"},"连接热点"),l("p",{class:"text-[10px] text-slate-500"},"Connect WiFi")],-1))]),l("form",{class:"card space-y-5",onSubmit:s[6]||(s[6]=i(()=>{},["prevent"]))},[l("button",{class:"w-full flex items-center justify-between p-4 rounded-xl bg-primary-500/10 border border-primary-500/20 hover:bg-primary-500/15 transition-colors group",onClick:s[0]||(s[0]=e=>Ke.value=!0)},[l("div",X,[l("div",Y,[t(n(A),{class:"w-5 h-5 text-primary-400"})]),s[12]||(s[12]=l("div",{class:"text-left"},[l("p",{class:"text-white font-medium"},"选择已知热点"),l("p",{class:"text-xs text-slate-500"},"从已保存的网络中选择")],-1))]),t(n(D),{class:"w-5 h-5 text-slate-500 group-hover:text-primary-400 transition-colors"})]),l("div",Z,[l("div",$,[l("label",ee,[t(n(q),{class:"w-4 h-4"}),s[13]||(s[13]=l("span",null,"WiFi 名称",-1))]),l("button",{type:"button",class:"flex items-center gap-1 px-2 py-1 rounded-md bg-primary-500/10 text-primary-400 text-xs font-medium hover:bg-primary-500/20 transition-colors mr-2",disabled:n(qe).isScanning,onClick:Ye},[t(n(I),{class:"w-3 h-3"}),s[14]||(s[14]=r(" 扫描 ",-1))],8,se)]),o(l("input",{"onUpdate:modelValue":s[1]||(s[1]=e=>Ie.value.ssid=e),type:"text",class:"input",placeholder:"输入 WiFi 名称"},null,512),[[c,Ie.value.ssid]])]),l("div",ae,[l("label",le,[t(n(J),{class:"w-4 h-4"}),s[15]||(s[15]=l("span",null,"安全性",-1))]),t(V,{modelValue:Ie.value.encryption,"onUpdate:modelValue":s[2]||(s[2]=e=>Ie.value.encryption=e),options:Je,placeholder:"选择加密方式",label:"选择加密方案"},null,8,["modelValue"])]),Oe.value?(x(),a("div",te,[l("label",ne,[t(n(E),{class:"w-4 h-4"}),s[16]||(s[16]=l("span",null,"WiFi 密码",-1))]),l("div",ie,[o(l("input",{"onUpdate:modelValue":s[3]||(s[3]=e=>Ie.value.key=e),type:W.value?"text":"password",class:"input pr-10",placeholder:"输入 WiFi 密码",autocomplete:"off"},null,8,re),[[u,Ie.value.key]]),l("button",{type:"button",class:"absolute right-3 top-1/2 -translate-y-1/2 text-slate-500 hover:text-primary-400 p-1 transition-colors",onClick:s[4]||(s[4]=e=>W.value=!W.value)},[(x(),d(p(W.value?n(L):n(U)),{class:"w-4 h-4"}))])])])):m("",!0),l("div",oe,[l("label",ce,[t(n(K),{class:"w-4 h-4"}),s[17]||(s[17]=l("span",null,"WiFi 频段",-1))]),t(V,{modelValue:Ie.value.band,"onUpdate:modelValue":s[5]||(s[5]=e=>Ie.value.band=e),options:[{value:"2G",label:"2.4G"},{value:"5G",label:"5G"}],placeholder:"选择 WiFi 频段",label:"选择 WiFi 频段"},null,8,["modelValue"])]),l("div",ue,[l("button",{class:"btn btn-secondary flex-1",onClick:ss},[t(n(A),{class:"w-4 h-4"}),s[18]||(s[18]=r(" 仅保存 ",-1))]),l("button",{class:"btn btn-primary flex-1",onClick:es},[t(n(T),{class:"w-4 h-4"}),s[19]||(s[19]=r(" 保存并连接 ",-1))])])],32)]),t(N,{visible:Ke.value,title:"选择已知热点",icon:n(A),onClose:s[8]||(s[8]=e=>Ke.value=!1)},{footer:v(()=>[l("button",{class:"btn btn-secondary w-full",onClick:s[7]||(s[7]=e=>Ke.value=!1)},"取消")]),default:v(()=>[l("div",de,[0===n(qe).knownNetworks.length?(x(),a("div",pe,[l("div",me,[t(n(A),{class:"w-8 h-8 text-slate-500"})]),s[20]||(s[20]=l("p",{class:"text-slate-400 mb-1"},"暂无已知热点",-1)),s[21]||(s[21]=l("p",{class:"text-xs text-slate-500"},"请先手动输入添加",-1))])):m("",!0),(x(!0),a(y,null,h(n(qe).knownNetworks,e=>(x(),a("div",{key:e.name,class:"flex justify-between items-center p-4 mx-2 mb-2 rounded-xl cursor-pointer transition-all duration-150 bg-dark-300/50 hover:bg-primary-500/10 border border-slate-700/50 hover:border-primary-500/30",onClick:s=>function(e){Ie.value.ssid=e.name,Ie.value.encryption=e.encryption||"psk2",Ie.value.key=e.password||"",Ie.value.band=e.band.toUpperCase(),Ke.value=!1}(e)},[l("div",ye,[l("div",fe,[t(n(q),{class:"w-5 h-5 text-primary-400"})]),l("span",be,w(e.name),1)]),l("div",xe,[l("span",he,w(e.band),1),(x(),d(p("none"===e.encryption||"owe"===e.encryption?n(B):n(E)),{class:k(["w-4 h-4","none"===e.encryption||"owe"===e.encryption?"text-warning-400":"text-success-400"])},null,8,["class"]))])],8,ve))),128))])]),_:1},8,["visible","icon"]),t(N,{visible:Be.value,title:"保存确认",icon:n(T),onClose:s[10]||(s[10]=e=>Be.value=!1)},{footer:v(()=>[l("button",{class:"btn btn-secondary flex-1",onClick:s[9]||(s[9]=e=>Be.value=!1)},"取消"),l("button",{class:"btn btn-primary flex-1",onClick:ls},[t(n(T),{class:"w-4 h-4"}),s[24]||(s[24]=r(" 确定连接 ",-1))])]),default:v(()=>[l("div",we,[s[23]||(s[23]=l("p",{class:"text-slate-300"},"确定要保存配置并连接吗？",-1)),l("div",ke,[t(n(S),{class:"w-5 h-5 text-warning-400 flex-shrink-0 mt-0.5"}),s[22]||(s[22]=l("div",{class:"text-sm"},[l("p",{class:"text-warning-300 font-medium mb-1"},"WiFi 将会重启"),l("p",{class:"text-slate-400"},"系统重启期间，WiFi连接将会断开。")],-1))])])]),_:1},8,["visible","icon"]),t(N,{visible:De.value,title:"附近热点",icon:n(I),onClose:$e},{footer:v(()=>[l("button",{class:k(["btn w-full gap-2 bg-gradient-to-r from-primary-500 to-primary-600 hover:from-primary-400 hover:to-primary-500 text-white font-medium shadow-lg shadow-primary-500/25 transition-all duration-200",{"opacity-70 cursor-not-allowed":n(qe).isScanning}]),disabled:n(qe).isScanning,onClick:Ze},[n(qe).isScanning?(x(),d(n(G),{key:0,class:"w-4 h-4 animate-spin"})):(x(),d(n(I),{key:1,class:"w-4 h-4"})),l("span",null,w(Te.value?"重新扫描":"开始扫描"),1)],10,_e)]),default:v(()=>[l("div",ge,[n(qe).isScanning?(x(),a("div",je,[l("div",Ce,[t(n(G),{class:"w-8 h-8 text-primary-400 animate-spin"})]),s[25]||(s[25]=l("p",{class:"text-slate-300 mb-1"},"正在扫描...",-1)),s[26]||(s[26]=l("p",{class:"text-xs text-slate-500"},"请稍等，大约需要 5 秒",-1))])):Te.value||0!==n(qe).scannedNetworks.length?Te.value&&0===n(qe).scannedNetworks.length?(x(),a("div",Se,[l("div",Ge,[t(n(O),{class:"w-8 h-8 text-slate-500"})]),s[28]||(s[28]=l("p",{class:"text-slate-400 mb-2"},"未找到热点",-1)),s[29]||(s[29]=l("p",{class:"text-xs text-slate-500 leading-relaxed text-center"},[r("建议用电脑网线连接路由器扫描"),l("br"),r("扫描过程中可能会断开 WiFi"),l("br"),r("不能 100% 收到返回结果"),l("br"),r('不过可以"重新扫描"试试')],-1))])):m("",!0):(x(),a("div",We,[l("div",Fe,[t(n(I),{class:"w-8 h-8 text-primary-400"})]),s[27]||(s[27]=l("p",{class:"text-slate-300"},"点击下方按钮开始扫描",-1))])),(x(!0),a(y,null,h(Xe.value,e=>{return x(),a("div",{key:e.bssid,class:"flex justify-between items-center p-4 mx-2 mb-2 rounded-xl cursor-pointer transition-all duration-150 bg-dark-300/50 hover:bg-primary-500/10 border border-slate-700/50 hover:border-primary-500/30",onClick:s=>function(e){var s,a,l,t,n;e.ssid?(Ie.value.ssid=e.ssid,Ie.value.encryption=(s=e.encryption).enabled?(null==(a=s.wpa)?void 0:a.includes(2))&&(null==(l=s.authentication)?void 0:l.includes("sae"))?"sae":(null==(t=s.wpa)?void 0:t.includes(2))?"psk2":(null==(n=s.wpa)?void 0:n.includes(1))?"psk":"psk2":"none",Ie.value.key="",Ie.value.band="2.4G"===e.band?"2G":"5G",De.value=!1):Ee.error("隐藏网络无法选择")}(e)},[l("div",Ne,[l("div",Pe,[(x(),a("svg",Ae,[l("circle",{cx:"12",cy:"19",r:"2",style:j({fill:Qe(e.signal).hex})},null,4),l("path",{d:"M8.5 15.5C9.5 14.5 10.7 14 12 14s2.5.5 3.5 1.5",style:j({stroke:Qe(e.signal).level>=1?Qe(e.signal).hex:"#475569"}),"stroke-width":"2","stroke-linecap":"round"},null,4),l("path",{d:"M5.5 12.5C7.3 10.7 9.5 10 12 10s4.7.7 6.5 2.5",style:j({stroke:Qe(e.signal).level>=2?Qe(e.signal).hex:"#475569"}),"stroke-width":"2","stroke-linecap":"round"},null,4),l("path",{d:"M2.5 9.5C5.2 6.8 8.4 6 12 6s6.8.8 9.5 3.5",style:j({stroke:Qe(e.signal).level>=3?Qe(e.signal).hex:"#475569"}),"stroke-width":"2","stroke-linecap":"round"},null,4)]))]),l("div",Ve,[l("p",Le,w(e.ssid),1),l("p",Ue,w(e.band)+" · "+w(Re(e.encryption)),1)])]),l("span",{class:k(["text-xs flex-shrink-0",(s=e.signal,s>=-65?"text-success-400":s>=-75?"text-warning-400":"text-danger-400")])},w(He(e.signal)),3)],8,Me);var s}),128))])]),_:1},8,["visible","icon"])],64))}});
/**
 * @license lucide-vue-next v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */export{ze as default};
