import{e,v as a,j as s,g as l,i as t,u as n,y as i,B as r,z as o,A as c,J as u,f as d,l as p,m,w as v,F as f,r as y,c as b,o as x,G as h,t as w,k as g,C as k,I as j}from"./vue-vendor.js";import{u as C}from"./wireless2.js";import{c as W,a as S,T as F,L as G}from"./index.js";import{D as N}from"./Dialog.js";import{S as M}from"./Select.js";import{a as P,s as _}from"./wireless3.js";import{S as A,i as V,a as L}from"./validation.js";import{W as T}from"./wifi.js";import{L as U}from"./lock.js";import{E as z,a as q}from"./eye.js";import{R as E}from"./radio.js";import{L as I}from"./lock-open.js";
/**
 * @license lucide-vue-next v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const K=W("chevron-right",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]),B=W("link",[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]]),D=W("search",[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]]),J=W("shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]),O=W("wifi-off",[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}],["path",{d:"M5 12.859a10 10 0 0 1 5.17-2.69",key:"1dl1wf"}],["path",{d:"M19 12.859a10 10 0 0 0-2.007-1.523",key:"4k23kn"}],["path",{d:"M2 8.82a15 15 0 0 1 4.177-2.643",key:"1grhjp"}],["path",{d:"M22 8.82a15 15 0 0 0-11.288-3.764",key:"z3jwby"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]),R={class:"space-y-4"},H={class:"flex items-center gap-3 px-1"},Q={class:"w-9 h-9 rounded-xl bg-gradient-to-br from-primary-500/20 to-primary-600/10 flex items-center justify-center"},X={class:"flex items-center gap-3"},Y={class:"w-10 h-10 rounded-lg bg-primary-500/20 flex items-center justify-center"},Z={class:"form-group"},$={class:"flex items-center justify-between"},ee={class:"form-label"},ae=["disabled"],se={class:"form-group"},le={class:"form-label"},te={key:0,class:"form-group"},ne={class:"form-label"},ie={class:"relative group/input"},re=["type"],oe={class:"form-group"},ce={class:"form-label"},ue={class:"flex gap-3 pt-2"},de={class:"max-h-72 overflow-y-auto -mx-2 scrollbar-smart"},pe={key:0,class:"text-center py-12"},me={class:"inline-flex items-center justify-center w-16 h-16 rounded-full bg-slate-700/50 mb-4"},ve=["onClick"],fe={class:"flex items-center gap-3"},ye={class:"w-10 h-10 rounded-lg bg-primary-500/20 flex items-center justify-center"},be={class:"text-white font-medium"},xe={class:"flex gap-2"},he={class:"badge"},we={class:"space-y-4"},ge={class:"flex items-start gap-3 p-4 rounded-xl bg-warning-500/10 border border-warning-500/20"},ke={class:"h-[280px] overflow-y-auto -mx-2 scrollbar-smart"},je={key:0,class:"flex flex-col items-center justify-center h-full"},Ce={class:"inline-flex items-center justify-center w-16 h-16 rounded-full bg-primary-500/10 mb-4"},We={key:1,class:"flex flex-col items-center justify-center h-full"},Se={class:"inline-flex items-center justify-center w-16 h-16 rounded-full bg-primary-500/10 mb-4"},Fe={key:2,class:"flex flex-col items-center justify-center h-full"},Ge={class:"inline-flex items-center justify-center w-16 h-16 rounded-full bg-slate-700/50 mb-4"},Ne=["onClick"],Me={class:"flex items-center gap-3 min-w-0 flex-1"},Pe={class:"w-10 h-10 rounded-lg bg-slate-800/50 flex items-center justify-center flex-shrink-0"},_e={class:"w-6 h-6",viewBox:"0 0 24 24",fill:"none"},Ae={class:"min-w-0 flex-1"},Ve={class:"text-white font-medium truncate"},Le={class:"text-xs text-slate-500"},Te={class:"w-full -mt-4"},Ue={class:"text-xs text-slate-500 text-center h-5 mb-1"},ze={key:0},qe=["disabled"],Ee=e({__name:"Connect",setup(e){const W=y(!1),Ee=k(),Ie=C(),Ke=S(),Be=y(!1),De=y(!1),Je=y(!1),Oe=y(!1),Re=y(""),He=y({ssid:"",encryption:"psk2",key:"",band:""}),Qe=[{value:"psk2",label:"WPA2-PSK (强安全性)"},{value:"sae",label:"WPA3-SAE (强安全性)"},{value:"psk",label:"WPA-PSK (弱安全性)"},{value:"owe",label:"OWE (开放网络)"},{value:"none",label:"无加密 (开放网络)"}],Xe=b(()=>"none"!==He.value.encryption&&"owe"!==He.value.encryption);function Ye(e){if(!e.enabled)return"无加密";const a=e.wpa||[];return a.includes(1)&&a.includes(2)?"WPA/WPA2":a.includes(2)?"WPA2":a.includes(1)?"WPA":"加密"}function Ze(e){return e>=-50?"极强":e>=-60?"强":e>=-70?"中":e>=-80?"弱":"极弱"}function $e(e){return e>=-50?{level:3,hex:"#4ade80"}:e>=-65?{level:2,hex:"#4ade80"}:e>=-75?{level:1,hex:"#fbbf24"}:{level:0,hex:"#f87171"}}a(async()=>{Ie.fetchKnownNetworks()});const ea=b(()=>Ie.scannedNetworks.filter(e=>e.ssid).sort((e,a)=>a.signal-e.signal));async function aa(){Je.value=!0;try{const[e,a]=await Promise.all([P("2g"),P("5g")]),s=(e.results||[]).map(e=>({...e,band:"2.4G"})),l=(a.results||[]).map(e=>({...e,band:"5G"})),t=[...s,...l];t.length>0&&(Ie.scannedNetworks=t,Oe.value=!0,Re.value=a.scan_time||e.scan_time||"")}catch{}}let sa=null,la=null;function ta(){sa&&(clearInterval(sa),sa=null),la&&(clearTimeout(la),la=null)}let na=!1,ia=!1;async function ra(){try{const[e,a]=await Promise.all([P("2g"),P("5g")]),s=(e.results||[]).map(e=>({...e,band:"2.4G"})),l=(a.results||[]).map(e=>({...e,band:"5G"}));return s.length>0&&!na&&(na=!0,Ie.scannedNetworks=[...Ie.scannedNetworks.filter(e=>"2.4G"!==e.band),...s],e.scan_time&&(Re.value=e.scan_time)),l.length>0&&!ia&&(ia=!0,Ie.scannedNetworks=[...Ie.scannedNetworks.filter(e=>"5G"!==e.band),...l],a.scan_time&&a.scan_time>(Re.value||"")&&(Re.value=a.scan_time)),!(!na||!ia)}catch{}return!1}async function oa(){Ie.isScanning||(Ie.isScanning=!0,Ie.scannedNetworks=[],Oe.value=!0,ta(),na=!1,ia=!1,Promise.all([_("2g"),_("5g")]).catch(()=>{}),setTimeout(async()=>{if(await ra())return ta(),void(Ie.isScanning=!1);sa=setInterval(async()=>{await ra()&&(ta(),Ie.isScanning=!1)},2e3)},5e3),la=setTimeout(()=>{ta(),Ie.isScanning=!1},2e4))}function ca(){Je.value=!1}function ua(){pa()&&(De.value=!0)}async function da(){if(!pa())return;await Ie.saveNetwork({name:He.value.ssid,encryption:He.value.encryption,password:He.value.key,band:He.value.band})?(Ke.success("配置已保存"),He.value={ssid:"",encryption:"psk2",key:"",band:""}):Ke.error(Ie.error||"保存失败")}function pa(){return V(He.value.ssid)?He.value.band?Xe.value&&!He.value.key?(Ke.error("请输入WiFi密码"),!1):!(Xe.value&&!L(He.value.key))||(Ke.error("密码只能包含英文、数字和符号，长度8-63位"),!1):(Ke.error("请选择频段"),!1):(Ke.error("请输入有效的WiFi名称 (1-32字符)"),!1)}async function ma(){De.value=!1,Ke.showLoading("正在尝试连接"),await Ie.saveNetwork({name:He.value.ssid,encryption:He.value.encryption,password:He.value.key,band:He.value.band});await Ie.connectToWiFi({ssid:He.value.ssid,encryption:He.value.encryption,key:He.value.key,band:He.value.band.toLowerCase()})?Ke.startCountdown(60,()=>{Ke.hideLoading(),Ee.push({name:"status"})}):(Ke.hideLoading(),Ke.error(Ie.error||"连接失败"))}return(e,a)=>(x(),s(f,null,[l("div",R,[l("div",H,[l("div",Q,[t(n(B),{class:"w-4 h-4 text-primary-400"})]),a[11]||(a[11]=l("div",null,[l("h2",{class:"text-lg font-bold text-white"},"连接热点"),l("p",{class:"text-[10px] text-slate-500"},"Connect WiFi")],-1))]),l("form",{class:"card space-y-5",onSubmit:a[6]||(a[6]=i(()=>{},["prevent"]))},[l("button",{class:"w-full flex items-center justify-between p-4 rounded-xl bg-primary-500/10 border border-primary-500/20 hover:bg-primary-500/15 transition-colors group",onClick:a[0]||(a[0]=e=>Be.value=!0)},[l("div",X,[l("div",Y,[t(n(A),{class:"w-5 h-5 text-primary-400"})]),a[12]||(a[12]=l("div",{class:"text-left"},[l("p",{class:"text-white font-medium"},"选择已知热点"),l("p",{class:"text-xs text-slate-500"},"从已保存的网络中选择")],-1))]),t(n(K),{class:"w-5 h-5 text-slate-500 group-hover:text-primary-400 transition-colors"})]),l("div",Z,[l("div",$,[l("label",ee,[t(n(T),{class:"w-4 h-4"}),a[13]||(a[13]=l("span",null,"WiFi 名称",-1))]),l("button",{type:"button",class:"flex items-center gap-1 px-2 py-1 rounded-md bg-primary-500/10 text-primary-400 text-xs font-medium hover:bg-primary-500/20 transition-colors mr-2",disabled:n(Ie).isScanning,onClick:aa},[t(n(D),{class:"w-3 h-3"}),a[14]||(a[14]=r(" 扫描 ",-1))],8,ae)]),o(l("input",{"onUpdate:modelValue":a[1]||(a[1]=e=>He.value.ssid=e),type:"text",class:"input",placeholder:"输入 WiFi 名称",autocomplete:"off"},null,512),[[c,He.value.ssid]])]),l("div",se,[l("label",le,[t(n(J),{class:"w-4 h-4"}),a[15]||(a[15]=l("span",null,"安全性",-1))]),t(M,{modelValue:He.value.encryption,"onUpdate:modelValue":a[2]||(a[2]=e=>He.value.encryption=e),options:Qe,placeholder:"选择加密方式",label:"选择加密方案"},null,8,["modelValue"])]),Xe.value?(x(),s("div",te,[l("label",ne,[t(n(U),{class:"w-4 h-4"}),a[16]||(a[16]=l("span",null,"WiFi 密码",-1))]),l("div",ie,[o(l("input",{"onUpdate:modelValue":a[3]||(a[3]=e=>He.value.key=e),type:W.value?"text":"password",class:"input pr-10",placeholder:"输入 WiFi 密码",autocomplete:"off"},null,8,re),[[u,He.value.key]]),l("button",{type:"button",class:"absolute right-3 top-1/2 -translate-y-1/2 text-slate-500 hover:text-primary-400 p-1 transition-colors",onClick:a[4]||(a[4]=e=>W.value=!W.value)},[(x(),d(p(W.value?n(z):n(q)),{class:"w-4 h-4"}))])])])):m("",!0),l("div",oe,[l("label",ce,[t(n(E),{class:"w-4 h-4"}),a[17]||(a[17]=l("span",null,"WiFi 频段",-1))]),t(M,{modelValue:He.value.band,"onUpdate:modelValue":a[5]||(a[5]=e=>He.value.band=e),options:[{value:"2G",label:"2.4G"},{value:"5G",label:"5G"}],placeholder:"选择 WiFi 频段",label:"选择 WiFi 频段"},null,8,["modelValue"])]),l("div",ue,[l("button",{class:"btn btn-secondary flex-1",onClick:da},[t(n(A),{class:"w-4 h-4"}),a[18]||(a[18]=r(" 仅保存 ",-1))]),l("button",{class:"btn btn-primary flex-1",onClick:ua},[t(n(B),{class:"w-4 h-4"}),a[19]||(a[19]=r(" 保存并连接 ",-1))])])],32)]),t(N,{visible:Be.value,title:"选择已知热点",icon:n(A),onClose:a[8]||(a[8]=e=>Be.value=!1)},{footer:v(()=>[l("button",{class:"btn btn-secondary w-full",onClick:a[7]||(a[7]=e=>Be.value=!1)},"取消")]),default:v(()=>[l("div",de,[0===n(Ie).knownNetworks.length?(x(),s("div",pe,[l("div",me,[t(n(A),{class:"w-8 h-8 text-slate-500"})]),a[20]||(a[20]=l("p",{class:"text-slate-400 mb-1"},"暂无已知热点",-1)),a[21]||(a[21]=l("p",{class:"text-xs text-slate-500"},"请先手动输入添加",-1))])):m("",!0),(x(!0),s(f,null,h(n(Ie).knownNetworks,e=>(x(),s("div",{key:e.name,class:"flex justify-between items-center p-4 mx-2 mb-2 rounded-xl cursor-pointer transition-all duration-150 bg-dark-300/50 hover:bg-primary-500/10 border border-slate-700/50 hover:border-primary-500/30",onClick:a=>function(e){He.value.ssid=e.name,He.value.encryption=e.encryption||"psk2",He.value.key=e.password||"",He.value.band=e.band.toUpperCase(),Be.value=!1}(e)},[l("div",fe,[l("div",ye,[t(n(T),{class:"w-5 h-5 text-primary-400"})]),l("span",be,w(e.name),1)]),l("div",xe,[l("span",he,w(e.band),1),(x(),d(p("none"===e.encryption||"owe"===e.encryption?n(I):n(U)),{class:g(["w-4 h-4","none"===e.encryption||"owe"===e.encryption?"text-warning-400":"text-success-400"])},null,8,["class"]))])],8,ve))),128))])]),_:1},8,["visible","icon"]),t(N,{visible:De.value,title:"保存确认",icon:n(B),onClose:a[10]||(a[10]=e=>De.value=!1)},{footer:v(()=>[l("button",{class:"btn btn-secondary flex-1",onClick:a[9]||(a[9]=e=>De.value=!1)},"取消"),l("button",{class:"btn btn-primary flex-1",onClick:ma},[t(n(B),{class:"w-4 h-4"}),a[24]||(a[24]=r(" 确定连接 ",-1))])]),default:v(()=>[l("div",we,[a[23]||(a[23]=l("p",{class:"text-slate-300"},"确定要保存配置并连接吗？",-1)),l("div",ge,[t(n(F),{class:"w-5 h-5 text-warning-400 flex-shrink-0 mt-0.5"}),a[22]||(a[22]=l("div",{class:"text-sm"},[l("p",{class:"text-warning-300 font-medium mb-1"},"WiFi 将会重启"),l("p",{class:"text-slate-400"},"系统重启期间，WiFi连接将会断开。")],-1))])])]),_:1},8,["visible","icon"]),t(N,{visible:Je.value,title:"附近热点",icon:n(D),onClose:ca},{footer:v(()=>[l("div",Te,[l("p",Ue,[Re.value&&!n(Ie).isScanning?(x(),s("span",ze,"扫描时间 "+w(Re.value),1)):m("",!0)]),l("button",{class:g(["btn w-full gap-2 bg-gradient-to-r from-primary-500 to-primary-600 hover:from-primary-400 hover:to-primary-500 text-white font-medium shadow-lg shadow-primary-500/25 transition-all duration-200",{"opacity-70 cursor-not-allowed":n(Ie).isScanning}]),disabled:n(Ie).isScanning,onClick:oa},[n(Ie).isScanning?(x(),d(n(G),{key:0,class:"w-4 h-4 animate-spin"})):(x(),d(n(D),{key:1,class:"w-4 h-4"})),l("span",null,w(Oe.value?"重新扫描":"开始扫描"),1)],10,qe)])]),default:v(()=>[l("div",ke,[n(Ie).isScanning?(x(),s("div",je,[l("div",Ce,[t(n(G),{class:"w-8 h-8 text-primary-400 animate-spin"})]),a[25]||(a[25]=l("p",{class:"text-slate-300 mb-1"},"正在扫描...",-1)),a[26]||(a[26]=l("p",{class:"text-xs text-slate-500"},"请稍等，大约需要 5 秒",-1))])):Oe.value||0!==n(Ie).scannedNetworks.length?Oe.value&&0===n(Ie).scannedNetworks.length?(x(),s("div",Fe,[l("div",Ge,[t(n(O),{class:"w-8 h-8 text-slate-500"})]),a[28]||(a[28]=l("p",{class:"text-slate-400 mb-2"},"未找到热点",-1)),a[29]||(a[29]=l("p",{class:"text-xs text-slate-500 leading-relaxed text-center"},[r("建议用电脑网线连接路由器扫描"),l("br"),r("扫描过程中可能会断开 WiFi"),l("br"),r("不能 100% 收到返回结果"),l("br"),r('不过可以"重新扫描"试试')],-1))])):m("",!0):(x(),s("div",We,[l("div",Se,[t(n(D),{class:"w-8 h-8 text-primary-400"})]),a[27]||(a[27]=l("p",{class:"text-slate-300"},"点击下方按钮开始扫描",-1))])),(x(!0),s(f,null,h(ea.value,e=>{return x(),s("div",{key:e.bssid,class:"flex justify-between items-center p-4 mx-2 mb-2 rounded-xl cursor-pointer transition-all duration-150 bg-dark-300/50 hover:bg-primary-500/10 border border-slate-700/50 hover:border-primary-500/30",onClick:a=>function(e){var a,s,l,t,n;e.ssid?(He.value.ssid=e.ssid,He.value.encryption=(a=e.encryption).enabled?(null==(s=a.wpa)?void 0:s.includes(2))&&(null==(l=a.authentication)?void 0:l.includes("sae"))?"sae":(null==(t=a.wpa)?void 0:t.includes(2))?"psk2":(null==(n=a.wpa)?void 0:n.includes(1))?"psk":"psk2":"none",He.value.key="",He.value.band="2.4G"===e.band?"2G":"5G",Je.value=!1):Ke.error("隐藏网络无法选择")}(e)},[l("div",Me,[l("div",Pe,[(x(),s("svg",_e,[l("circle",{cx:"12",cy:"19",r:"2",style:j({fill:$e(e.signal).hex})},null,4),l("path",{d:"M8.5 15.5C9.5 14.5 10.7 14 12 14s2.5.5 3.5 1.5",style:j({stroke:$e(e.signal).level>=1?$e(e.signal).hex:"#475569"}),"stroke-width":"2","stroke-linecap":"round"},null,4),l("path",{d:"M5.5 12.5C7.3 10.7 9.5 10 12 10s4.7.7 6.5 2.5",style:j({stroke:$e(e.signal).level>=2?$e(e.signal).hex:"#475569"}),"stroke-width":"2","stroke-linecap":"round"},null,4),l("path",{d:"M2.5 9.5C5.2 6.8 8.4 6 12 6s6.8.8 9.5 3.5",style:j({stroke:$e(e.signal).level>=3?$e(e.signal).hex:"#475569"}),"stroke-width":"2","stroke-linecap":"round"},null,4)]))]),l("div",Ae,[l("p",Ve,w(e.ssid),1),l("p",Le,w(e.band)+" · "+w(Ye(e.encryption)),1)])]),l("span",{class:g(["text-xs flex-shrink-0",(a=e.signal,a>=-65?"text-success-400":a>=-75?"text-warning-400":"text-danger-400")])},w(Ze(e.signal)),3)],8,Ne);var a}),128))])]),_:1},8,["visible","icon"])],64))}});
/**
 * @license lucide-vue-next v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */export{Ee as default};
